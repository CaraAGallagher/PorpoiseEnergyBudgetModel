ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(aes(2.5,75, label=(paste(expression("y = 0.37852 * x")))),parse = TRUE)
MovementPlot
p <- locator(1)
p
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(aes(-0.3,2.2, label=(paste(expression("y = 0.37852 * x")))),parse = TRUE)
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(aes(2.5,75, label=(paste(expression("y = 0.37852 * x")))),parse = TRUE)
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=-0.3, y=2.22, label="y = 0.37852 * x",parse = TRUE)
m <-lm(y ~ 0 + x)
plot(x,y, xlim=c(0,4.5), ylim=c(0, 1.7), ylab = "Swimspeed-6 sec intervals (m/s)", xlab= "log(Swimspeed-30 min intervals (m/s) * 100)")
lines(x,predict(m),lty=2,col="red",lwd=3)
p <- data.frame(x, y, "m" = predict(m))
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=-0.3, y=2.22, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
p <- locator(1)
p
p <- data.frame(x, y, "m" = predict(m))
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=2.22, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=0, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=-10, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=-2, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=-1, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=0.5, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=1.5, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.5, y=1.5, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=1.2, y=1.5, label="y = 0.37852 * x",parse = TRUE)
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=1.2, y=1.5, label=paste("y = 0.37852 * x"),parse = TRUE)
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
df <- data.frame(x, y)
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
theme_classic() + geom_text(x=0.3, y=1.5, label=lm_eqn(df),parse = TRUE)
MovementPlot
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=0.3, y=1.5, label=lm_eqn(df),parse = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=0.3, y=1.5), label=lm_eqn(df),parse = TRUE) + theme_classic()
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=0.3, y=1.5), label=lm_eqn(df),parse = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=0.3, y=1.5, label=lm_eqn(df)),parse = TRUE) + theme_classic()
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=0.3, y=1.5, label=lm_eqn(df)),parse = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=0.3, y=1.5, label=lm_eqn(df)),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=1, y=1.5, label=lm_eqn(df)),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(aes(x=1, y=1.5, label=lm_eqn(df)),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
m <-lm(y ~ 0 + x)
# load data
load("/Volumes/Leviathan/Dynamic Porpoise Project/Tables/Data/Movement Data/Dead_reck_dataset_list.RData")
dat<- cbind(dr.data.list[[1]], dr.data.list[[2]])
dat <- dat[7:nrow(dat),]
rownames(dat) <- NULL
# convert time to POSIX time
dat$DateTime <-ISOdatetime(dat$year, dat$month, dat$day, dat$hour, dat$minute, dat$second, tz = "")
dat$DateTime <- as.POSIXct(dat$DateTime, format="%Y-%m-%d %H:%M:%S")
# estimate data intervals of dead reckoned data
dat$TimeDiff <- c()
dat$TimeDiff[1] <- 0
for (i in 2:nrow(dat)) {
m <- dat$DateTime[i] - dat$DateTime[i-1]
dat$TimeDiff[i] <- m
}
# use x y to estimate distance traveled per time interval
dat$DistanceTravelled <- c()
dat$DistanceTravelled[1] <- 0
for (i in 2:nrow(dat)) {
m <-  sqrt((dat$x[i] - dat$x[i-1])^2 + (dat$y[i] - dat$y[i-1])^2)
dat$DistanceTravelled[i] <- m
}
# extract data once every 30 minutes
b <- seq(1, 10501, 300)
ThirtyMinData <-dat[b,]
# calculate distance travelled between data on 30 min scale
ThirtyMinData$DistanceTravelled[1] <- 0
for (i in 2:36) {
m <-  sqrt((ThirtyMinData$x[i] - ThirtyMinData$x[i-1])^2 + (ThirtyMinData$y[i] - ThirtyMinData$y[i-1])^2)
ThirtyMinData$DistanceTravelled[i] <- m
}
# check time interval
ThirtyMinData$TimeDiff[1] <- 0
for (i in 2:nrow(ThirtyMinData)) {
m <- ThirtyMinData$DateTime[i] - ThirtyMinData$DateTime[i-1]
ThirtyMinData$TimeDiff[i] <- m
}
rownames(ThirtyMinData) <- NULL
ThirtyMinData <- ThirtyMinData[2:36,]
rownames(ThirtyMinData) <- NULL
# now focus on 6 s scale
FineScaleData <- dat[1:10500,]
boo <- list(rep(1:35, each=300))
# aggregate data per 30 minute bins and sum distance travelled
FineScaleDist <- aggregate(FineScaleData$DistanceTravelled,boo, FUN=sum)
FineScaleDist
# consolidate distance travelled data for 30 minute and 6 s interval estimates
CompData <- data.frame(cbind(ThirtyMinData$DistanceTravelled, FineScaleDist$x))
colnames(CompData) <- c("ThirtyMinuteDistance", "FineScaleDistance")
# estimate speed in m/s (1800 secs in 30 min)
CompData$ThirtyMinSpeed <- CompData$ThirtyMinuteDistance/1800
CompData$FineScaleSpeed <- CompData$FineScaleDistance/1800
CompData<- CompData[order(CompData$ThirtyMinSpeed),]
# plot results
x <- 1:nrow(CompData)
plot(x,CompData$ThirtyMinSpeed, ylim=c(0,2), col = "blue", ylab="Speed (m/s)")
points(x,CompData$FineScaleSpeed, col="orangered")
lines(predict(lm(CompData$FineScaleSpeed~x)),col="orangered")
lines(predict(lm(CompData$ThirtyMinSpeed~x)),col="blue")
legend("topright", legend=c("30 min", "6 s"), col=c("blue", "orangered"), lty=1)
x <- log((as.numeric(CompData$ThirtyMinSpeed)) * 100)
y <- as.numeric(CompData$FineScaleSpeed)
m <-lm(y ~ 0 + x)
plot(x,y, xlim=c(0,4.5), ylim=c(0, 1.7), ylab = "Swimspeed-6 sec intervals (m/s)", xlab= "log(Swimspeed-30 min intervals (m/s) * 100)")
lines(x,predict(m),lty=2,col="red",lwd=3)
p <- locator(1)
p <- data.frame(x, y, "m" = predict(m))
df <- data.frame(x, y)
lm_eqn <- function(df){
m <- lm(y ~ 0 + x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
lm_eqn <- function(df){
m <- lm(y ~ x + 0, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
m <-lm(y ~ x + 0)
summary(m)
lm_eqn <- function(df){
m <- lm(y ~ x + 0, df);
eq <- substitute(italic(y) == a %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1.25, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1.25, y=1.5, label=lm_eqn(df)[1],parse = TRUE, check_overlap = TRUE) +
geom_text(x=1.25, y=1.5, label=lm_eqn(df)[2],parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
labels = lm_eqn(df)
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1.25, y=1.5, label=labels[1],parse = TRUE, check_overlap = TRUE) +
geom_text(x=1.25, y=1.5, label=labels[2],parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1.25, y=1.5, label=labels[1],parse = TRUE, check_overlap = TRUE) +
geom_text(x=1.25, y=1.1, label=labels[2],parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
labels
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1, y=2, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=1, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=0.8, y=1.5, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=0.8, y=1.7, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=0.8, y=1.6, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
tiff("SwimspeedEstimation.tiff", height = 10, width = 10, units = 'cm', compression = "lzw", res = 300)
MovementPlot
dev.off()
load("/Volumes/Leviathan/Dynamic Porpoise Project/Tables/Data/Movement Data/Dead_reck_dataset_list.RData")
#head(dr.data.list)
dat<- cbind(dr.data.list[[1]], dr.data.list[[2]])
dat <- dat[7:nrow(dat),]
rownames(dat) <- NULL
# convert time to POSIX time
dat$DateTime <-ISOdatetime(dat$year, dat$month, dat$day, dat$hour, dat$minute, dat$second, tz = "")
dat$DateTime <- as.POSIXct(dat$DateTime, format="%Y-%m-%d %H:%M:%S")
# estimate data intervals of dead reckoned data
dat$TimeDiff <- c()
dat$TimeDiff[1] <- 0
for (i in 2:nrow(dat)) {
m <- dat$DateTime[i] - dat$DateTime[i-1]
dat$TimeDiff[i] <- m
}
# use x y to estimate distance traveled per time interval
dat$DistanceTravelled <- c()
dat$DistanceTravelled[1] <- 0
for (i in 2:nrow(dat)) {
m <-  sqrt((dat$x[i] - dat$x[i-1])^2 + (dat$y[i] - dat$y[i-1])^2)
dat$DistanceTravelled[i] <- m
}
# extract data once every 30 minutes
b <- seq(1, 10501, 300)
ThirtyMinData <-dat[b,]
# calculate distance travelled between data on 30 min scale
ThirtyMinData$DistanceTravelled[1] <- 0
for (i in 2:36) {
m <-  sqrt((ThirtyMinData$x[i] - ThirtyMinData$x[i-1])^2 + (ThirtyMinData$y[i] - ThirtyMinData$y[i-1])^2)
ThirtyMinData$DistanceTravelled[i] <- m
}
# check time interval
ThirtyMinData$TimeDiff[1] <- 0
for (i in 2:nrow(ThirtyMinData)) {
m <- ThirtyMinData$DateTime[i] - ThirtyMinData$DateTime[i-1]
ThirtyMinData$TimeDiff[i] <- m
}
rownames(ThirtyMinData) <- NULL
ThirtyMinData <- ThirtyMinData[2:36,]
rownames(ThirtyMinData) <- NULL
# now focus on 6 s scale
FineScaleData <- dat[1:10500,]
boo <- list(rep(1:35, each=300))
# aggregate data per 30 minute bins and sum distance travelled
FineScaleDist <- aggregate(FineScaleData$DistanceTravelled,boo, FUN=sum)
FineScaleDist
# consolidate distance travelled data for 30 minute and 6 s interval estimates
CompData <- data.frame(cbind(ThirtyMinData$DistanceTravelled, FineScaleDist$x))
colnames(CompData) <- c("ThirtyMinuteDistance", "FineScaleDistance")
# estimate speed in m/s (1800 secs in 30 min)
CompData$ThirtyMinSpeed <- CompData$ThirtyMinuteDistance/1800
CompData$FineScaleSpeed <- CompData$FineScaleDistance/1800
CompData<- CompData[order(CompData$ThirtyMinSpeed),]
# plot results
x <- 1:nrow(CompData)
plot(x,CompData$ThirtyMinSpeed, ylim=c(0,2), col = "blue", ylab="Speed (m/s)")
points(x,CompData$FineScaleSpeed, col="orangered")
lines(predict(lm(CompData$FineScaleSpeed~x)),col="orangered")
lines(predict(lm(CompData$ThirtyMinSpeed~x)),col="blue")
legend("topright", legend=c("30 min", "6 s"), col=c("blue", "orangered"), lty=1)
x <- log((as.numeric(CompData$ThirtyMinSpeed)) * 100)
y <- as.numeric(CompData$FineScaleSpeed)
m <-lm(y ~ x + 0)
plot(x,y, xlim=c(0,4.5), ylim=c(0, 1.7), ylab = "Swimspeed-6 sec intervals (m/s)", xlab= "log(Swimspeed-30 min intervals (m/s) * 100)")
lines(x,predict(m),lty=2,col="red",lwd=3)
p <- locator(1)
p
text(0.6,1.55, labels = "y = 0.37852 * x")
require(ggplot2)
p <- data.frame(x, y, "m" = predict(m))
df <- data.frame(x, y)
lm_eqn <- function(df){
m <- lm(y ~ x + 0, df);
eq <- substitute(italic(y) == a %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(coef(m)[1], digits = 2),
b = format(coef(m)[2], digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
MovementPlot <- ggplot(p, aes(x=p$x, y=p$y)) + xlim(0,4.5) + ylim(0, 1.7) + geom_point() +
ylab( "Swimspeed-6 sec intervals (m/s)") + xlab("log(Swimspeed-30 min intervals (m/s) * 100)")  +
geom_line(data=p, aes(x=p$x, y=p$m), size=0.9, color="seagreen4", linetype="dashed") +
geom_text(x=0.8, y=1.6, label=lm_eqn(df),parse = TRUE, check_overlap = TRUE) + theme_classic()
MovementPlot
tiff("SwimspeedEstimation.tiff", height = 10, width = 15, units = 'cm', compression = "lzw", res = 300)
MovementPlot
dev.off()
malobsmass = rnorm(1000, 74.3,  19.2)
femalcontmass = rnorm(1000, 46, 9.3)
femalobsmass = rnorm(1000, 75.8,  18.7)
malcontmass = rnorm(1000, 44.5, 11.6)
malcontRMR = rnorm(1000, 5600, 973)
malobsRMR = rnorm(1000, 7222,  1219)
femalcontRMR = rnorm(1000, 5112, 632)
femalobsRMR = rnorm(1000, 6665,  1105)
malcontmass = rnorm(10000, 44.5, 11.6)
malobsmass = rnorm(1000, 74.3,  19.2)
femalcontmass = rnorm(10000, 46, 9.3)
femalobsmass = rnorm(10000, 75.8,  18.7)
malcontRMR = rnorm(10000, 5600, 973)
malobsRMR = rnorm(10000, 7222,  1219)
femalcontRMR = rnorm(10000, 5112, 632)
femalobsRMR = rnorm(10000, 6665,  1105)
mcont = malcontRMR / malcontmass
mobs = malobsRMR / malobsmass
fcont = femalcontRMR / femalcontmass
fobs = femalobsRMR / femalobsmass
mean(mcont)
sd(mcont)
mean(mcont)
mean(mobs)
sd(mobs)
mean(fcont)
sd(fcont)
mean(fobs)
sd(fobs)
malcontmass = rnorm(10000, 44.5, 11.6)
malobsmass = (rnorm(1000, 74.3,  19.2)*0.75)
femalcontmass = rnorm(10000, 46, 9.3)
femalobsmass = (rnorm(10000, 75.8,  18.7)*0.75)
mcont = malcontRMR / malcontmass
mobs = malobsRMR / malobsmass
mean(mcont)
sd(mcont)
mean(mobs)
sd(mobs)
fcont = femalcontRMR / femalcontmass
fobs = femalobsRMR / femalobsmass
mean(fcont)
sd(fcont)
mean(fobs)
sd(fobs)
library(raster)
library(rasterVis)
temp.raster.import <- list.files(path="/Volumes/Leviathan/PEB_Model/raster-data/Kattegat/TemperatureData")
temp.raster.import <- c(temp.raster.import[1],temp.raster.import[5],temp.raster.import[6],temp.raster.import[7],temp.raster.import[8],temp.raster.import[9],temp.raster.import[10],temp.raster.import[11],temp.raster.import[12],temp.raster.import[2],temp.raster.import[3],temp.raster.import[4])
setwd("/Volumes/Leviathan/PEB_Model/raster-data/Kattegat/TemperatureData")
TempData <- stack()
for (i in 1:length(temp.raster.import)) {
r <- raster(temp.raster.import[i])
TempData <- stack(TempData, r)
}
salinity.raster.import <- list.files(path="/Volumes/Leviathan/PEB_Model/raster-data/Kattegat/SalinityData")
salinity.raster.import <- c(salinity.raster.import[1],salinity.raster.import[5],salinity.raster.import[6],salinity.raster.import[7],salinity.raster.import[8],salinity.raster.import[9],salinity.raster.import[10],salinity.raster.import[11],salinity.raster.import[12],salinity.raster.import[2],salinity.raster.import[3],salinity.raster.import[4])
setwd("/Volumes/Leviathan/PEB_Model/raster-data/Kattegat/SalinityData")
SalData <- stack()
for (i in 1:length(salinity.raster.import)) {
r <- raster(salinity.raster.import[i])
SalData <- stack(SalData, r)
}
indices <- c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
names(TempData) <- indices
names(SalData) <- indices
library("wesanderson")
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500, colorkey = list(space = "top"))
m
pal1 <- wes_palette("Zissou1", 1000, type = "continuous")
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500, colorkey = list(space = "top"))
m
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500, colorkey = list(title = "top"))
m
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500)
m
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500, colorkey = list(title = "degC"))
m
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500, colorkey = list(title = "degC", at=1:21))
m
p <- locator(1)
m <- m + mtext("Original map", 1, line=-3.4, adj=0.4)
m <- levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500)
m <- m + mtext("Original map", 1, line=-3.4, adj=0.4)
m
+ mtext("Original map", 1, line=-3.4, adj=0.4)
levelplot(TempData,col.regions=pal1, at=seq(0, 20, len=100), xlab="Latitude (UTM)", ylab="Longitude (UTM)", main="Water Temperature by Month IDW", maxpixels=500) +
mtext("Original map", 1, line=-3.4, adj=0.4)
